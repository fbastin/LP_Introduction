\documentclass[usepdftitle=false]{beamer}
\usepackage[utf8]{inputenc}

\usetheme{Singapore}
\usepackage{xcolor}

% \setbeamercovered{transparent}
%\usecolortheme{crane}
\title[IFT2505]{IFT 2505\\Programmation Linéaire\\Dualité}
\author[Fabian Bastin]{Fabian Bastin\\DIRO\\Université de Montréal\\}
\date{}

\setbeamertemplate{footline}[frame number]

\usepackage[frenchb]{babel}

\usepackage{ulem}
\usepackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
    \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}

\def\ba{\boldsymbol{a}}
\def\bb{\boldsymbol{b}}
\def\bc{\boldsymbol{c}}
\def\be{\boldsymbol{e}}
\def\br{\boldsymbol{r}}
\def\bu{\boldsymbol{u}}
\def\bx{\boldsymbol{x}}
\def\by{\boldsymbol{y}}
\def\bz{\boldsymbol{z}}
\def\bA{\boldsymbol{A}}
\def\bB{\boldsymbol{B}}
\def\bD{\boldsymbol{D}}
\def\bH{\boldsymbol{H}}
\def\bI{\boldsymbol{I}}
\def\bL{\boldsymbol{L}}
\def\bM{\boldsymbol{M}}
\def\bU{\boldsymbol{U}}
\def\bzero{\boldsymbol{0}}
\def\blambda{\boldsymbol{\lambda}}

\def\cR{\mathcal{R}}

\begin{document}
\frame{\titlepage}

% ------------------------------------------------------------------------------------------------------------------------------------------------------\begin{frame}

\begin{frame}
\frametitle{Dualité}

Nous considérons le problème, dit {\bf primal}:
\begin{align*}
\min_x \ & c^T x \\
\mbox{t.q. } & Ax \geq b \\
& x \geq 0
\end{align*}

\mbox{}

Le programme suivant est appelé {\bf dual}:
\begin{align*}
\max_{\lambda} \ & \lambda^T b \\
\mbox{t.q. } & A^T \lambda \leq c \\
& \lambda \geq 0
\end{align*}
$A \in \cR^{m \times n}$, $c, x, \in \cR^n$, $\lambda, b \in \cR^m$.

Note: les contraintes duales peuvent aussi s'écrire $\lambda^T A \leq c^T$ (en appliquant l'opérateur de transposition de part et d'autre de l'inégalité).

\end{frame}

\begin{frame}
\frametitle{Dualité}

$x$: variables du problème primal\\
$\lambda$: variables du problèmes dual

\mbox{}

Dual du dual?

\mbox{}

\begin{align*}
\min_x \ & c^T x \\
\mbox{t.q. } & Ax \geq b \\
& x \geq 0
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Dualité: forme standard}

\begin{align*}
\min_x \ & c^T x \\
\mbox{t.q. } & Ax = b \\
& x \geq 0
\end{align*}

revient à

\begin{align*}
\min_x \ & c^T x \\
\mbox{t.q. } & Ax \geq b \\
& -Ax \geq -b \\
& x \geq 0
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Dualité: forme standard}

Le dual peut alors s'écrire
\begin{align*}
\max_{u, v} \ & u^T b - v^T b \\
\mbox{t.q. } & u^T A - v^T A \leq c^T \\
& u \geq 0 \\
& v \geq 0
\end{align*}
ou, avec $\lambda = u - v$,
\begin{align*}
\max_{\lambda} \ & \lambda^T b \\
\mbox{t.q. } & \lambda^T A \leq c^T \\
\end{align*}

Forme asymétrique: $\lambda \in \cR$.

\end{frame}

\begin{frame}
\frametitle{Conversion primal-dual}

\begin{center}
\begin{tabular}{|c|c|}
\hline
\hline
{\bf Minimisation} & {\bf Maximisation} \\
\hline
\hline
Contraintes & Variables \\
$\geq$ & $\geq 0$ \\
$\leq$ & $\leq 0$ \\
$=$ & non restreint \\
\hline
Variables & Contraintes \\
\hline
$\geq 0$ & $\leq$ \\
$\leq 0$ & $\geq$ \\
non restreint & $=$ \\
\hline
\end{tabular}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Conversion primal-dual: exemples}

\begin{minipage}[t]{0.49\textwidth}
\begin{center}
Primal

\mbox{}

\hrule
\begin{align*}
\min_x\ & c^Tx \\
\mbox{t.q } & Ax = b, \\
& x \geq 0. 
\end{align*}
\end{center}
\end{minipage}
\begin{minipage}[t]{0.49\textwidth}
\begin{center}
Dual

\mbox{}

\hrule
\begin{align*}
\max_{\lambda}\ & b^T\lambda \\
\mbox{t.q. } & A^T\lambda \leq c. 
\end{align*}
\end{center}
\end{minipage}

\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\min_x\ & c^Tx \\
\mbox{t.q. } & Ax \geq b, \\
& x \geq 0. 
\end{align*}
\end{center}
\end{minipage}
%\hspace*{\stretch{1}}
\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\max_{\lambda}\ & b^T\lambda \\
\mbox{t.q. } & A^T\lambda \leq c, \\
& \lambda \geq 0. 
\end{align*}
\end{center}
\end{minipage}

\end{frame}

\begin{frame}
\frametitle{Conversion primal-dual: exemples}

\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\max_x\ & c^Tx \\
\mbox{t.q. } & Ax = b, \\
& x \geq 0. 
\end{align*}
\end{center}
\end{minipage}
\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\min_{\lambda}\ & b^T\lambda \\
\mbox{t.q. } & A^T\lambda \geq c. \\
\end{align*}
\end{center}
\end{minipage}

\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\min_x\ & c^Tx \\
\mbox{t.q } & Ax \leq b, \\
& x \geq 0. 
\end{align*}
\end{center}
\end{minipage}
\begin{minipage}[t]{0.49\textwidth}
\begin{center}
\begin{align*}
\max_{\lambda}\ & b^T\lambda \\
\mbox{t.q } & A^T\lambda \leq c, \\
& \lambda \leq 0. 
\end{align*}
\end{center}
\end{minipage}

\end{frame}

\begin{frame}
\frametitle{Exemple: le problème de regime alimentaire}

\begin{itemize}
\item
$x_j$: unités de produit alimentaire
\item
$n$ produits
\item
$b$: besoins minimums ($b_i$: $i^e$ nutriment)
\item
$c$: coût
\item
$m$ nutriments
\item
$a_{ij}$: unités de nutriments $i$ dans le produit $j$.
\end{itemize}

Primal: on veut minimiser sa consommation tout en satisfaisant les besoins minimums
\begin{align*}
\min_x \ & c^T x \\
\mbox{t.q. } & Ax \geq b \\
& x \geq 0
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Exemple: le problème de regime alimentaire}

Dual:
\begin{align*}
\max_{\lambda} \ & \lambda^T b \\
\mbox{t.q. } & \lambda^T A \leq c^T \\
& \lambda \geq 0
\end{align*}

$\lambda$ pourrait par exemple représenter le prix de compléments alimentaires; on veut maximiser le revenu de la vente de tels compléments.

\mbox{}

La contrainte traduit qu'on doit rester compétitif: le prix des compléments doivent rester inférieurs au coût des aliments originaux.

\end{frame}

\begin{frame}
\frametitle{Exemple}

Considérons le problème
\begin{align*}
\min\ &z = -4x_1 - 3x_2 -x_3 -2x_4 \\
\mbox{t.q. } & 4x_1 + 2x_2 + x_3 + x_4 \leq 5 \\
& 3x_1 + x_2 + 2x_3 + x_4 \leq 4 \\
& x_j \geq 0,\ j = 1,\ldots 6.
\end{align*}

Pour obtenir la forme standard, nous devons ajouter 2 variables d'écart, disons $x_5$ et $x_6$. Ceci donne le problème
\begin{align*}
\min\ &z = -4x_1 - 3x_2 -x_3 -2x_4 \\
\mbox{t.q. } & 4x_1 + 2x_2 + x_3 + x_4 + x_5 = 5 \\
& 3x_1 + x_2 + 2x_3 + x_4 + x_6 = 4 \\
& x_j \geq 0,\ j = 1,\ldots 6.
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Exemple}

Sous forme tableau, ceci se traduit par
\[
\begin{matrix}
x_1 & x_2 & x_3 & x_4 & x_5 & x_6 & b \\
4 & 2 & 1 & 1 & 1 & 0 & 5 \\
3 & 1 & 2 & 1 & 0 & 1 & 4 \\
-4 & -3 & -1 & -2 & 0 & 0 & 0
\end{matrix}
\]
Le système est déjà sous forme canonique, et nous pouvons identifier les variables de base $x_5$ et $x_6$. A ce système correspondent
\[
A = \begin{pmatrix}
4 & 2 & 1 & 1 & 1 & 0 \\
3 & 1 & 2 & 1 & 0 & 1 \\
\end{pmatrix},\qquad
b = \begin{pmatrix} 5 \\ 4 \end{pmatrix}
\]
Plutôt que de devoir travailler sur toutes les colonnes de $A$ en permanence, nous allons utiliser la version révisée du simplexe.

\end{frame}

\begin{frame}
\frametitle{Exemple}

Nous cherchons d'abord à calculer les coûts réduits, en notant que
\[
B = \begin{pmatrix}
1 & 0 \\
0 & 1 \\
\end{pmatrix},\qquad 
B^{-1} = \begin{pmatrix}
1 & 0 \\
0 & 1 \\
\end{pmatrix}
\]

Nous avons
\[
\lambda^T = c_B^T B^{-1} =
\begin{pmatrix} 0 & 0 \end{pmatrix}B^{-1} = \begin{pmatrix} 0 & 0 \end{pmatrix}
\]
Dès lors,
\[
r_D^T = c_D^T - \lambda^T D = c_D^T =
\begin{pmatrix} -4 & -3 & -1 & -2 \end{pmatrix}
\]
Il existe des coûts réduits négatifs, aussi nous n'avons pas terminé.

\mbox{}

Une possibilité est de faire entrer $x_1$.

\end{frame}

\begin{frame}
\frametitle{Exemple}

Dans la base courante,
\[
y_1 = B^{-1}a_1 = \begin{pmatrix} 4 \\ 3 \end{pmatrix}
\]
Le pivotage peut se résumer à
\[
\begin{matrix}
    & x_5 & x_6 & b & y_1 \\
x_5 & 1 & 0 & 5 & 4 \\
x_6 & 0 & 1 & 4 & 3 \\
-z & 0 & 0 & 0 & -4
\end{matrix}
\]
Le mininum des rapports composante par composante entre $b$ et $y_1$, pour les éléments strictement positifs de $y_1$, est 5/4. Autrement dit, $x_1$ entre dans la base et $x_5$ sort.
La réduction du tableau donne
\[
\begin{matrix}
    & x_5 & x_6 & b & y_1 \\
x_1 & 1/4 & 0 & 5/4 & 1 \\
x_6 & -3/4 & 1 & 1/4 & 0 \\
-z & 1 & 0 & 5 & 0
\end{matrix}
\]

\end{frame}

\begin{frame}
\frametitle{Exemple}

Du tableau précédent, nous tirons
\[
B^{-1} =
\begin{pmatrix}
1/4 & 0 \\
-3/4 & 1
\end{pmatrix}
\]
et en conséquence
\[
\lambda^T = \begin{pmatrix} -4 & 0 \end{pmatrix}
\begin{pmatrix}
1/4 & 0 \\
-3/4 & 1
\end{pmatrix} =  
\begin{pmatrix} -1 & 0 \end{pmatrix}
\]
Les coûts réduits deviennent
\begin{align*}
r_D^T &=
\begin{pmatrix}
-3 & -1 & -2 & 0
\end{pmatrix}
-
\begin{pmatrix}
-1 & 0
\end{pmatrix}
\begin{pmatrix}
2 & 1 & 1 & 1 \\
1 & 2 & 1 & 0
\end{pmatrix} \\
&=
\begin{pmatrix}
-3 & -1 & -2 & 0
\end{pmatrix} +
\begin{pmatrix}
2 & 1 & 1 & 1
\end{pmatrix} \\
&=
\begin{pmatrix}
-1 & 0 & -1 & 1
\end{pmatrix}
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Exemple}

Il a des coûts réduits strictement négatifs, aussi on doit continuer. On choisit ici le premier coût, autrement dit on fait entrée $x_2$, lequel est associé à
\[
y_2 = B^{-1}a_2 =
\begin{pmatrix}
1/4 & 0 \\
-3/4 & 1
\end{pmatrix}
\begin{pmatrix}
2 \\ 1
\end{pmatrix}
=
\begin{pmatrix}
1/2 \\ -1/2
\end{pmatrix}
\]
Procédons au pivotage:
\[
\begin{matrix}
    & x_5 & x_6 & b & y_2 \\
x_1 & 1/4 & 0 & 5/4 & 1/2 \\
x_6 & -3/4 & 1 & 1/4 & -1/2 \\
-z & 1 & 0 & 5 & -1
\end{matrix}
\]
\[
\begin{matrix}
    & x_5 & x_6 & b & y_2 \\
x_2 & 1/2 & 0 & 5/2 & 1 \\
x_6 & -1/2 & 1 & 3/2 & 0 \\
-z & 3/2 & 0 & 15/2 & 0
\end{matrix}
\]

\end{frame}

\begin{frame}
\frametitle{Exemple}

Nous obtenons
\[
B^{-1} =
\begin{pmatrix}
1/2 & 0 \\
-1/2 & 1
\end{pmatrix}
\]
et donc
\[
\lambda^T = \begin{pmatrix} -3 & 0 \end{pmatrix}
\begin{pmatrix}
1/2 & 0 \\
-1/2 & 1
\end{pmatrix} =  
\begin{pmatrix} -3/2 & 0 \end{pmatrix}
\]

Les coûts réduits valent
\begin{align*}
r_D^T &=
\begin{pmatrix}
-4 & -1 & -2 & 0
\end{pmatrix}
-
\begin{pmatrix}
-3/2 & 0
\end{pmatrix}
\begin{pmatrix}
4 & 1 & 1 & 1 \\
3 & 2 & 1 & 0
\end{pmatrix} \\
&=
\begin{pmatrix}
-4 & -1 & -2 & 0
\end{pmatrix} +
\begin{pmatrix}
6 & 3/2 & 3/2 & 3/2
\end{pmatrix} \\
&=
\begin{pmatrix}
2 & 1/2 & -1/2 & 3/2
\end{pmatrix}
\end{align*}
La variable d'entrée doit être $x_4$.

\end{frame}

\begin{frame}
\frametitle{Exemple}

Nous avons
\[
y_4 = 
\begin{pmatrix}
1/2 & 0 \\
-1/2 & 1
\end{pmatrix}
\begin{pmatrix}
1 \\ 1
\end{pmatrix}
=
\begin{pmatrix}
1/2 \\ 1/2
\end{pmatrix}
\]
Cela conduit au tableau
\[
\begin{matrix}
    & x_5 & x_6 & b & y_2 \\
x_2 & 1/2 & 0 & 5/2 & 1/2 \\
x_6 & -1/2 & 1 & 3/2 & 1/2 \\
-z & 3/2 & 0 & 15/2 & -1/2
\end{matrix}
\]
et $x_6$ doit sortir de la base. Le pivotage conduit à
\[
\begin{matrix}
    & x_5 & x_6 & b & y_2 \\
x_2 & 1 & -1 & 1 & 0 \\
x_4 & -1 & 2 & 3 & 1 \\
-z & 1 & 1 & 9 & 0
\end{matrix}
\]

\end{frame}

\begin{frame}
\frametitle{Exemple}

Dès lors
\[
B^{-1} =
\begin{pmatrix}
1 & -1 \\
-1 & 2
\end{pmatrix},
\]
\[
\lambda^T = \begin{pmatrix} -3 & -2 \end{pmatrix}
\begin{pmatrix}
1 & -1 \\
-1 & 2
\end{pmatrix} =  
\begin{pmatrix} -1 & -1 \end{pmatrix}
\]

Les coûts réduits sont
\begin{align*}
r_D^T &=
\begin{pmatrix}
-4 & -1 & 0 & 0
\end{pmatrix}
-
\begin{pmatrix}
-1 & -1
\end{pmatrix}
\begin{pmatrix}
4 & 1 & 1 & 0 \\
3 & 2 & 0 & 1
\end{pmatrix} \\
&=
\begin{pmatrix}
-4 & -1 & 0 & 0
\end{pmatrix} +
\begin{pmatrix}
7 & 3 & 1 & 1
\end{pmatrix} \\
&=
\begin{pmatrix}
3 & 2 & 1 & 1
\end{pmatrix}
\end{align*}
Tous les coûts réduits sont positifs. La base $B_3$ est donc optimale. La solution associée à $B_3$ est
\[
\begin{pmatrix}
0 & 1 & 0 & 3 & 0 & 0
\end{pmatrix}
\]
pour une valeur optimale de -9.

\end{frame}

\begin{frame}
\frametitle{Exemple: dual}

Reprenons le problème primal.
\begin{align*}
\min\ &z = -4x_1 - 3x_2 -x_3 -2x_4 \\
\mbox{t.q. } & 4x_1 + 2x_2 + x_3 + x_4 \leq 5 \\
& 3x_1 + x_2 + 2x_3 + x_4 \leq 4 \\
& x_j \geq 0,\ j = 1,\ldots 4.
\end{align*}
Formons le dual
\begin{align*}
\max\ & 5\lambda_1 + 4\lambda_2 \\
\mbox{t.q. } &
4\lambda_1 + 3\lambda_2 \leq -4 \\
& 2\lambda_1 + \lambda_2 \leq -3 \\
& \lambda_1 + 2\lambda_2 \leq -1 \\
& \lambda_1 + \lambda_2 \leq -2 \\
& \lambda_1 \leq 0, \lambda_2 \leq 0.
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Exemple: dual}

Essayons de nous rapprocher de la forme standard:
\begin{align*}
-\min\ & -5\lambda_1 - 4\lambda_2 \\
\mbox{t.q. } &
-4\lambda_1 - 3\lambda_2 \geq 4 \\
& -2\lambda_1 - \lambda_2 \geq 3 \\
& -\lambda_1 - 2\lambda_2 \geq 1 \\
& -\lambda_1 - \lambda_2 \geq 2 \\
& -\lambda_1 \geq 0, -\lambda_2 \geq 0.
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Exemple: dual}

En posant $y_i = -\lambda_i$, en ajoutant des variables de surplus, et en oubliant temporairement le signe négatif devant l'opérateur de minimisation, nous avons
\begin{align*}
\min\ & 5y_1 + 4y_2 \\
\mbox{t.q. } &
4y_1 + 3y_2 - y_3 = 4 \\
& 2y_1 + y_2 - y_4 = 3 \\
& y_1 + 2y_2 - y_5 = 1 \\
& y_1 + y_2 -y_6 = 2 \\
& y_1 \geq 0, y_2 \geq 0.\\
& y_3 \geq 0, y_4 \geq 0, y_5 \geq 0, y_6 \geq 0.
\end{align*}

En résolvant ce problème (avec par exemple une méthode à deux phases), nous obtenons la solution optimale
\[
y^* =
\begin{pmatrix}
1 & 1 & 0 & 0 & 0 & 0
\end{pmatrix}
\]
pour la valeur optimale 9.

\end{frame}

\begin{frame}
\frametitle{Exemple: dual}

En repassant au dual original, cela donne une valeur optimale de -9 et
\[
\lambda^* =
\begin{pmatrix}
-1 & -1
\end{pmatrix}
\]
comme lors du dernier calcul dans le simplexe révisé pour le primal.

\mbox{}

Est-ce un hasard? Pas vraiment\ldots

\end{frame}

\begin{frame}
\frametitle{Dualité faible}

(Forme symétrique ou forme asymétrique -- forme standard)

\mbox{}

Si $x$ and $\lambda$ sont réalisables pour le primal et le dual, respectivement, alors
\[
c^T x \geq \lambda^T b
\]

\begin{proof}
\[
\lambda^T b \leq \lambda^TAx \leq c^Tx,
\]
pour $x \geq 0$, vu que $x$ est supposé realisable, et que du dual, $\lambda^T A \leq c^T$.
\end{proof}

Dès lors, l'objectif primal est une borne supérieure pour le dual, et vice-versa.

\end{frame}

\begin{frame}
\frametitle{Corollaire}

Si $x_0$ et $\lambda_0$ sont réalisables pour le primal et le dual, respectivement, et si
\[
c^T x_0 = \lambda_0^T b,
\]
alors $x_0$ et $\lambda_0$ sont optimaux pour leur problème respectif.

\mbox{}

Mais on n'a encore dit sur la réalisabilité d'un problème par rapport à l'autre!

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

Si un des problèmes, primal ou dual, a une solution optimale finie, l'autre problème a aussi une solution optimale finie, et les valeurs correspondantes des fonctions objectifs sont égales. Si l'un des problèmes a un objectif non borné, l'autre problème n'a pas de solution réalisable.

\begin{proof}
La deuxième affirmation est une conséquence directe du lemme.

\mbox{}

Ainsi si le primal est non borné et $\lambda$ est réalisable pour le dual, nous devons avoir
\[
\lambda^T b \leq -M
\]
pour $M$ arbitrairement grand, ce qui est impossible.

\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

\begin{proof}
Si le primal a une solution optimale finie, nous voulons montrer que le dual a une solution optimale finie.

\mbox{}

Soit $z^*$ la valeur optimale du primal. Définissons
\begin{align*}
C = \lbrace & (r, w): r = tz^* - c^Tx,\\
& w = tb-Ax, \mbox{ avec } x \geq 0,\ t \geq 0 \rbrace
\end{align*}

\mbox{}

$C$ est un cône convexe fermé:
\begin{itemize}
\item
cône: pour $\alpha > 0$ et $(r,w) \in C$, alors $\alpha(r,w) \in C$;
\item
convexe: soient $(r_1, w_1)$ et $(r_2, w_2) \in C$, alors $\forall\, \lambda \in (0,1)$, $\lambda(r_1, w_1) + (1 -\lambda) (r_2, w_2) \in C$.
\item
fermé: $(0,0) \in C$.
\end{itemize}

\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

\begin{proof}

Mais $(1,0) \notin C$. Par l'absurde, supposons $(1,0) \in C$.

Nous avons donc $w = 0$, et de là, il existe un certain couple $(t_0, x_0)$ tel que $t_0b - Ax_0$ = 0. Deux cas sont envisageables:
\begin{itemize}
\item
Si $t_0 > 0$, alors
$x = x_0/t_0$ est réalisable pour le primal comme $Ax = b$ et $x \geq 0$, étant donné que $x_0 \geq 0$.
Ainsi $r/t_0 = z^* - c^Tx_0/t_0 \leq 0$, comme $z^* \leq c^Tx$. Autrement dit, $r \leq 0$, alors qu'on supposait $r = 1$.
\item
Si $t_0 = 0$, alors $w = Ax_0 = 0$, avec $x_0 \geq 0$.
D'autre part, $1 = r = t_0z^* - c^Tx_0 = -c^Tx_0$, et donc $c^T x_0 = -1$.

Si $x$ est réalisable pour le primal, alors $x+\alpha x_0$ est realisable pour tout $\alpha \geq 0$, comme $A(x+\alpha x_0) = Ax + \alpha A x_0 = Ax = b$, et $x+\alpha x_0 \geq 0$.

De plus, $c^T(x+\alpha x_0) = c^Tx - \alpha$ peut être diminué à l'infini, en augmentant $\alpha$. Ceci contredit l'existence d'un minimum fini.
\end{itemize}

\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

\begin{proof}
Donc, $(1,0) \notin C$.

\mbox{}

Comme $C$ est un ensemble convexe fermé, cela implique qu'il existe un hyperplan séparant $(1,0)$ et $C$. Autrement dit, $\exists [s, \lambda] \in \cR^{m+1}$, $[s, \lambda] \ne 0$, et une constante $k$ t.q.
\begin{align*}
s = (s, \lambda)^T (1,0) &< \inf \lbrace (s, \lambda)^T(r,w) \mbox{ t.q. } (r,w) \in C \rbrace \\
& = \inf \lbrace sr + \lambda^Tw \mbox{ t.q. } (r,w) \in C \rbrace = k
\end{align*}
Comme $C$ est un cône, $k \geq 0$. En effet, si $k < 0$, $\exists (r,w) \in C$ t.q. $sr + \lambda^T w = \kappa < 0$.
De plus, pour tout $\alpha \geq 0$, $\alpha (r,w) \in C$. Comme $s \alpha r + \lambda^T  \alpha w = \alpha\kappa$, pour $\alpha$ assez grand, $\alpha (r,w)$ violerait l'inégalité de l'hyperplan.

\mbox{}

Mais $(0,0) \in C$, donc $k \leq 0$, et de là, $k = 0$, et $s < 0$.
\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

\begin{proof}
Prenons $\beta = -s$. Comme $C$ est un cône, nous avons
\begin{align*}
-1 = \frac{1}{\beta}s &= \frac{1}{\beta}(s,\lambda)^T(1,0) \\
&< \frac{1}{\beta}\inf \lbrace sr + \lambda^Tw \mbox{ t.q. } (r,w) \in C \rbrace \\
&= \frac{1}{\beta}\inf \lbrace s\beta r + \lambda^T \beta w \mbox{ t.q. } (r,w) \in C \rbrace \\
&= \inf \lbrace s r + \lambda^T w \mbox{ t.q. } (r,w) \in C \rbrace.
\end{align*}
Aussi, sans perte de généralités, $s = -1$

\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité forte}

\begin{proof}
Comme $\inf \lbrace s r + \lambda^T w \mbox{ t.q. } (r,w) \in C \rbrace = 0$, si $s = -1$, nous avons $\exists \lambda \in \cR^m$ t.q.
\[
-r + \lambda^Tw \geq 0,\ \forall (r,w) \in C.
\]
De manière équivalente, par définition de $C$,
\[
(c^T-\lambda^TA)x - tz^* + t\lambda^T b \geq 0,\ \forall x, t \geq 0.
\]

\mbox{}

$t = 0$ donne $\lambda^T A \leq c^T$, i.e. $\lambda$ est réalisable pour le dual.\\
$x = 0$ et $t = 1$ donne $\lambda^T b \geq z^*$. Par le lemme 1 et son corollaire, $\lambda$ est optimal pour le dual.

\mbox{}

Comme le dual du dual est le primal, la preuve est complète.
\end{proof}

\end{frame}

\begin{frame}
\frametitle{Dualité: compatibilité}

Si un programme est non réalisable, cela n'implique cependant pas que son dual soit non borné. Celui-ci peut être non réalisable.

\mbox{}

Le tableau ci-dessous synthétise les différents cas de figure possibles.

\begin{center}
\begin{tabular}{|c||c|c|c|}
\hline
Primal / Dual & Borné & Non borné & Non réalisable \\
\hline
\hline
Borné & possible & impossible & impossible \\
\hline
Non borné & impossible & impossible & possible \\
\hline
Non réalisable & impossible & possible & possible \\
\hline
\end{tabular}
\end{center}

\end{frame}

\end{document}
